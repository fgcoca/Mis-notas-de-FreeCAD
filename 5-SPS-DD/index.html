<!doctype html><html lang=es class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Mis notas sobre el uso de esta herramienta libre documentada utilizando la versión estable 0.20 de FreeCAD o bien alguna versión 0.21 Conda en desarrollo"><meta name=author content="Federico Coca"><link href=https://fgcoca.github.io/Mis-notas-de-FreeCAD/5-SPS-DD/ rel=canonical><link rel=icon href=../img/favicon.png><meta name=generator content="mkdocs-1.3.1, mkdocs-material-8.4.0"><title>5. Hojas de cálculo y datos dinámicos - Mis notas de FreeCAD</title><link rel=stylesheet href=../assets/stylesheets/main.69437709.min.css><link rel=stylesheet href=../assets/stylesheets/palette.cbb835fc.min.css><meta name=theme-color content=#02a6f2><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme data-md-color-primary=light-blue data-md-color-accent=deep-purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#5-hojas-de-calculo-y-datos-dinamicos class=md-skip> Saltar a contenido </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Cabecera> <a href=.. title="Mis notas de FreeCAD" class="md-header__button md-logo" aria-label="Mis notas de FreeCAD" data-md-component=logo> <img src=../img/favicon.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Mis notas de FreeCAD </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 5. Hojas de cálculo y datos dinámicos </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Búsqueda placeholder=Búsqueda autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Limpiar tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Inicializando búsqueda </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/fgcoca/Mis-notas-de-FreeCAD title="Ir al repositorio" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> fgcoca/Mis-notas-de-FreeCAD </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navegación data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="Mis notas de FreeCAD" class="md-nav__button md-logo" aria-label="Mis notas de FreeCAD" data-md-component=logo> <img src=../img/favicon.png alt=logo> </a> Mis notas de FreeCAD </label> <div class=md-nav__source> <a href=https://github.com/fgcoca/Mis-notas-de-FreeCAD title="Ir al repositorio" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> fgcoca/Mis-notas-de-FreeCAD </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> Preliminar </a> </li> <li class=md-nav__item> <a href=../intro/ class=md-nav__link> 1. Introducción </a> </li> <li class=md-nav__item> <a href=../2-PD/ class=md-nav__link> 2. Banco de trabajo PartDesign </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> 3. Planos de referencia <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="3. Planos de referencia" data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> 3. Planos de referencia </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../3-porquePR/ class=md-nav__link> 3.0. ¿Por qué debemos usar planos de referencia? </a> </li> <li class=md-nav__item> <a href=../3-plano-ref/ class=md-nav__link> 3.1. Plano de referencia que pasa por tres puntos </a> </li> <li class=md-nav__item> <a href=../3-PR-fijo-objeto/ class=md-nav__link> 3.2. Plano de referencia fijado a objeto </a> </li> <li class=md-nav__item> <a href=../3-PR-normal/ class=md-nav__link> 3.3. Plano de referencia normal </a> </li> <li class=md-nav__item> <a href=../3-PR-fijo-cara-plana/ class=md-nav__link> 3.4. Plano de referencia fijado a cara plana </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../4-parametros/ class=md-nav__link> 4. Diseño paramétrico en FreeCAD. Otros enfoques </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> 5. Hojas de cálculo y datos dinámicos <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> 5. Hojas de cálculo y datos dinámicos </a> <nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Tabla de contenidos </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#51-banco-de-trabajo-spreadsheet class=md-nav__link> 5.1. Banco de trabajo Spreadsheet </a> <nav class=md-nav aria-label="5.1. Banco de trabajo Spreadsheet"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#511-herramientas class=md-nav__link> 5.1.1. Herramientas </a> </li> <li class=md-nav__item> <a href=#512-preferencias class=md-nav__link> 5.1.2. Preferencias </a> </li> <li class=md-nav__item> <a href=#513-insertar-y-eliminar-filas-y-columnas class=md-nav__link> 5.1.3. Insertar y eliminar filas y columnas </a> </li> <li class=md-nav__item> <a href=#514-cortar-copiar-y-pegar-celdas class=md-nav__link> 5.1.4. Cortar, copiar y pegar celdas </a> </li> <li class=md-nav__item> <a href=#515-propiedades-de-las-celdas class=md-nav__link> 5.1.5. Propiedades de las celdas </a> </li> <li class=md-nav__item> <a href=#516-expresiones class=md-nav__link> 5.1.6. Expresiones </a> </li> <li class=md-nav__item> <a href=#517-recalculos-en-modelos-complejos class=md-nav__link> 5.1.7. Recálculos en modelos complejos </a> </li> <li class=md-nav__item> <a href=#518-unidades class=md-nav__link> 5.1.8. Unidades </a> </li> <li class=md-nav__item> <a href=#519-enlaces-entre-celdas class=md-nav__link> 5.1.9. Enlaces entre celdas </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#52-banco-de-trabajo-dynamicdata class=md-nav__link> 5.2. Banco de trabajo DynamicData </a> <nav class=md-nav aria-label="5.2. Banco de trabajo DynamicData"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#521-herramientas class=md-nav__link> 5.2.1. Herramientas </a> </li> <li class=md-nav__item> <a href=#522-utilizacion-basica-de-dynamicdata class=md-nav__link> 5.2.2. Utilización básica de DynamicData </a> </li> <li class=md-nav__item> <a href=#523-importar-restricciones-de-un-boceto-a-dynamicdata class=md-nav__link> 5.2.3. Importar restricciones de un boceto a DynamicData </a> </li> <li class=md-nav__item> <a href=#524-importar-restricciones-de-una-hoja-de-calculo-a-un-objeto-dynamicdata class=md-nav__link> 5.2.4. Importar restricciones de una hoja de cálculo a un objeto DynamicData </a> </li> <li class=md-nav__item> <a href=#525-copia-de-propiedades class=md-nav__link> 5.2.5. Copia de propiedades </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../6-TD/ class=md-nav__link> 6. Dibujo técnico </a> </li> <li class=md-nav__item> <a href=../7-tornillos/ class=md-nav__link> 7. Tornillos y tuercas </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_9 type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9> 8. Curvas en FreeCAD <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="8. Curvas en FreeCAD" data-md-level=1> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> 8. Curvas en FreeCAD </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../8_1-repaso-curvas/ class=md-nav__link> 8.1. Repaso de conceptos básicos sobre curvas en FreeCAD </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_10 type=checkbox id=__nav_10> <label class=md-nav__link for=__nav_10> Miscelanea <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Miscelanea data-md-level=1> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> Miscelanea </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Miscelanea/about/ class=md-nav__link> Autor </a> </li> <li class=md-nav__item> <a href=../Miscelanea/lic/ class=md-nav__link> Licencias </a> </li> <li class=md-nav__item> <a href=../Miscelanea/webgrafia/ class=md-nav__link> Webgrafia/Bibliografía </a> </li> <li class=md-nav__item> <a href=../Miscelanea/soft/ class=md-nav__link> Software utilizado </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Tabla de contenidos </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#51-banco-de-trabajo-spreadsheet class=md-nav__link> 5.1. Banco de trabajo Spreadsheet </a> <nav class=md-nav aria-label="5.1. Banco de trabajo Spreadsheet"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#511-herramientas class=md-nav__link> 5.1.1. Herramientas </a> </li> <li class=md-nav__item> <a href=#512-preferencias class=md-nav__link> 5.1.2. Preferencias </a> </li> <li class=md-nav__item> <a href=#513-insertar-y-eliminar-filas-y-columnas class=md-nav__link> 5.1.3. Insertar y eliminar filas y columnas </a> </li> <li class=md-nav__item> <a href=#514-cortar-copiar-y-pegar-celdas class=md-nav__link> 5.1.4. Cortar, copiar y pegar celdas </a> </li> <li class=md-nav__item> <a href=#515-propiedades-de-las-celdas class=md-nav__link> 5.1.5. Propiedades de las celdas </a> </li> <li class=md-nav__item> <a href=#516-expresiones class=md-nav__link> 5.1.6. Expresiones </a> </li> <li class=md-nav__item> <a href=#517-recalculos-en-modelos-complejos class=md-nav__link> 5.1.7. Recálculos en modelos complejos </a> </li> <li class=md-nav__item> <a href=#518-unidades class=md-nav__link> 5.1.8. Unidades </a> </li> <li class=md-nav__item> <a href=#519-enlaces-entre-celdas class=md-nav__link> 5.1.9. Enlaces entre celdas </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#52-banco-de-trabajo-dynamicdata class=md-nav__link> 5.2. Banco de trabajo DynamicData </a> <nav class=md-nav aria-label="5.2. Banco de trabajo DynamicData"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#521-herramientas class=md-nav__link> 5.2.1. Herramientas </a> </li> <li class=md-nav__item> <a href=#522-utilizacion-basica-de-dynamicdata class=md-nav__link> 5.2.2. Utilización básica de DynamicData </a> </li> <li class=md-nav__item> <a href=#523-importar-restricciones-de-un-boceto-a-dynamicdata class=md-nav__link> 5.2.3. Importar restricciones de un boceto a DynamicData </a> </li> <li class=md-nav__item> <a href=#524-importar-restricciones-de-una-hoja-de-calculo-a-un-objeto-dynamicdata class=md-nav__link> 5.2.4. Importar restricciones de una hoja de cálculo a un objeto DynamicData </a> </li> <li class=md-nav__item> <a href=#525-copia-de-propiedades class=md-nav__link> 5.2.5. Copia de propiedades </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=5-hojas-de-calculo-y-datos-dinamicos><font color=#8B008B>5. Hojas de cálculo y datos dinámicos</font><a class=headerlink href=#5-hojas-de-calculo-y-datos-dinamicos title="Permanent link">&para;</a></h1> <p>En este apartado vamos a describir y aplicar lo descrito en la <a href=https://wiki.freecadweb.org/Spreadsheet_Workbench>wiki de FreeCAD sobre Spreadsheet</a> y también veremos la idea básica de trabajar con Calc, la hoja de cálculo de LibreOffice que por supuesto es externa al programa pero ofrece muchas mas posibilidades de cálculo que la del programa.</p> <h2 id=51-banco-de-trabajo-spreadsheet><font color=#007575><strong>5.1. Banco de trabajo Spreadsheet</strong></font><a class=headerlink href=#51-banco-de-trabajo-spreadsheet title="Permanent link">&para;</a></h2> <p>Ya hemos visto el uso básico de este banco de trabajo en el apartado 4 y ahora vamos a profundizar un poco mas en el mismo.</p> <h3 id=511-herramientas><font color=#AA0000>5.1.1. Herramientas</font><a class=headerlink href=#511-herramientas title="Permanent link">&para;</a></h3> <p>En la tabla siguiente vemos los iconos de las herramientas disponibles y una descripción breve de para que sirve cada una de ellas.</p> <p><center></p> <table> <thead> <tr> <th align=center>Icono</th> <th>Descripción</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Crear hoja" src=../img/SS-DD/iconos/png/Spreadsheet_CreateSheet.png></td> <td>Crea una nueva hoja de cálculo</td> </tr> <tr> <td align=center><img alt=Importar src=../img/SS-DD/iconos/png/Spreadsheet_Import.png></td> <td>Importa desde un archivo CSV a una hoja de cálculo</td> </tr> <tr> <td align=center><img alt=Exportar src=../img/SS-DD/iconos/png/Spreadsheet_Export.png></td> <td>Exportar a un archivo CSV desde una hoja de cálculo</td> </tr> <tr> <td align=center><img alt="Unir celdas" src=../img/SS-DD/iconos/png/Spreadsheet_MergeCells.png></td> <td>Une las celdas seleccionadas</td> </tr> <tr> <td align=center><img alt="Dividir celdas" src=../img/SS-DD/iconos/png/Spreadsheet_SplitCell.png></td> <td>Divide celdas que previamente han sido unidas</td> </tr> <tr> <td align=center><img alt="Alinear a la izquierda" src=../img/SS-DD/iconos/png/Spreadsheet_AlignLeft.png></td> <td>Alinea el contenido de las celdas seleccionadas a la izquierda</td> </tr> <tr> <td align=center><img alt="Alinear al centro" src=../img/SS-DD/iconos/png/Spreadsheet_AlignCenter.png></td> <td>Alinea el contenido de las celdas seleccionadas al centro horizontalmente</td> </tr> <tr> <td align=center><img alt="Alinear a la derecha" src=../img/SS-DD/iconos/png/Spreadsheet_AlignRight.png></td> <td>Alinea el contenido de las celdas seleccionadas a la derecha</td> </tr> <tr> <td align=center><img alt="Alinear arriba" src=../img/SS-DD/iconos/png/Spreadsheet_AlignTop.png></td> <td>Alinea el contenido de las celdas seleccionadas a la parte superior de las mismas</td> </tr> <tr> <td align=center><img alt="Alinear al centro en vertical" src=../img/SS-DD/iconos/png/Spreadsheet_AlignVCenter.png></td> <td>Alinea el contenido de las celdas seleccionadas al centro verticalmente</td> </tr> <tr> <td align=center><img alt="Alinear abajo" src=../img/SS-DD/iconos/png/Spreadsheet_AlignBottom.png></td> <td>Alinea el contenido de las celdas seleccionadas a la parte inferior de las mismas</td> </tr> <tr> <td align=center><img alt="Estilo negrita" src=../img/SS-DD/iconos/png/Spreadsheet_StyleBold.png></td> <td>Establece el contenido de las celdas seleccionadas a negrita</td> </tr> <tr> <td align=center><img alt="Estilo itálica" src=../img/SS-DD/iconos/png/Spreadsheet_StyleItalic.png></td> <td>Establece el contenido de las celdas seleccionadas a itálica</td> </tr> <tr> <td align=center><img alt="Estilo subrayar" src=../img/SS-DD/iconos/png/Spreadsheet_StyleUnderline.png></td> <td>Establece el contenido de las celdas seleccionadas a subrayar</td> </tr> <tr> <td align=center><img alt="Establecer alias" src=../img/SS-DD/iconos/png/Spreadsheet_SetAlias.png></td> <td>Establece el alias o nombre para una celda seleccionada</td> </tr> <tr> <td align=center><img alt="Negro y Blanco" src=../img/SS-DD/iconos/png/ByN.png></td> <td>Establecen los colores de primer plano y de fondo de las celdas seleccionadas</td> </tr> </tbody> </table> <p></center></p> <h3 id=512-preferencias><font color=#AA0000>5.1.2. Preferencias</font><a class=headerlink href=#512-preferencias title="Permanent link">&para;</a></h3> <p>Las preferencias de hojas de cálculo las encontramos siguiendo la ruta indicada en la animación de la Figura 5.1 y solamente estarán disponibles después de abrir un documento que contenga una hoja de cálculo o después de visitar el banco de trabajo Spreadsheet. Cada vez que iniciemos FreeCAD va a ser necesario visitar al menos una vez el banco de trabajo DynamicData para que las herramientas queden disponibles.</p> <p><center></p> <p><img alt="Acceso a Preferencias de Spreadsheet" src=../img/SS-DD/F5_1.gif><br> <em>Figura 5.1. Acceso a Preferencias de Spreadsheet</em></p> <p></center></p> <p>Solamente tenemos una pestaña: 'Hoja de cálculo' en donde se puede configurar lo siguiente:</p> <ul> <li><strong>Carácter delimitador</strong>. Es el carácter utilizado como delimitador de campos.</li> <li><strong>Carácter de Entrecomillado</strong>. Es el carácter utilizado para delimitar cadenas.</li> <li><strong>Carácter de escape</strong>. Es el carácter utilizado para evitar que se analice el siguiente carácter.</li> </ul> <p>En definitiva son los caracteres a configurar acordes con nuestra hoja de cálculo para importar y exportar archivos CSV.</p> <h3 id=513-insertar-y-eliminar-filas-y-columnas><font color=#AA0000>5.1.3. Insertar y eliminar filas y columnas</font><a class=headerlink href=#513-insertar-y-eliminar-filas-y-columnas title="Permanent link">&para;</a></h3> <p>Podemos insertar o eliminar filas y columnas haciendo clic con el botón derecho del ratón en un encabezado de fila o columna y seleccionando la opción apropiada en el menú contextual. Es posible seleccionar primero varias filas o columnas, bien manteniendo presionado la tecla Ctrl al seleccionar los encabezados, o manteniendo presionado el botón izquierdo del ratón y arrastrándolo. En la animación de la Figura 5.2 se ilustra esto. Hemos puesto unos nombre simples a las celdas para que se hagan patentes los cambios.</p> <p><center></p> <p><img alt="Insertar y eliminar filas y columnas" src=../img/SS-DD/F5_2.gif><br> <em>Figura 5.2. Insertar y eliminar filas y columnas</em></p> <p></center></p> <p><font color=#FF0000>Debemos tener muy presente que eliminar filas o columnas que contengan datos puede romper el funcionamiento de la hoja de cálculo y/o de la pieza que se basa en la hoja de cálculo sin que recibamos ningún tipo de aviso al respecto.</font></p> <h3 id=514-cortar-copiar-y-pegar-celdas><font color=#AA0000>5.1.4. Cortar, copiar y pegar celdas</font><a class=headerlink href=#514-cortar-copiar-y-pegar-celdas title="Permanent link">&para;</a></h3> <p>Las operaciones clásicas de cortar, copiar y pegar se pueden usar en las celdas de hojas de cálculo de FreeCAD y además utilizando los atajos normales de teclado para estas operaciones: Ctrl+X Ctrl+C y Ctrl+V respectivamente. Para seleccionar múltiples celdas mantendremos presionada la tecla Ctrl mientras las vamos seleccionando, o mantenemos presionado el botón izquierdo del ratón y arrastramos para seleccionar un rango de celdas que se contenga en un barrido rectangular.</p> <p>Las operaciones de cortar y copiar almacenan el contenido y las propiedades de las celdas en el portapapeles. La operación de pegar escribe los datos del portapapeles en la celda indicada. La operación de copiar crea un recuadro en verde alrededor de la celda o celdas a copiar mientras que cortar hace lo propio con el recuadro en color rojo. La operación de pegar actualiza el contenido de la celda o celdas y las fórmulas se actualizan como consecuencia de la operación. En la animación de la Figura 5.3 vemos como se realizan varias de estas operaciones. La animación se inicia copiando un celda que contiene una fórmula y vemos que se copia pero actualizando las referencias a celdas, lo que hace que la fórmula no trabaje correctamente. </p> <p><center></p> <p><img alt="Cortar, copiar y pegar celdas" src=../img/SS-DD/F5_3.gif><br> <em>Figura 5.3. Cortar, copiar y pegar celdas</em></p> <p></center></p> <p>N<font color=#FF0000>Debemos tener muy presente que eliminar filas o columnas que contengan datos puede romper el funcionamiento de la hoja de cálculo y/o de la pieza que se basa en la hoja de cálculo sin que recibamos ningún tipo de aviso al respecto.</font></p> <h3 id=515-propiedades-de-las-celdas><font color=#AA0000>5.1.5. Propiedades de las celdas</font><a class=headerlink href=#515-propiedades-de-las-celdas title="Permanent link">&para;</a></h3> <p>Las propiedades de una celda de nuestra hoja de cálculo se pueden editar haciendo clic con el botón derecho teniendo el cursor situado en la celda y seleccionando Propiedades del menú contextual. En la Figura 5.4 vemos la ventana que se muestra.</p> <p><center></p> <p><img alt="Propiedades de las celdas" src=../img/SS-DD/F5_4.png><br> <em>Figura 5.4. Propiedades de las celdas</em></p> <p></center></p> <p>En la animación de la Figura 5.5 podemos ver como trabajar con estas propiedades de una forma sencilla aplicando los cambios a una sola celda aunque esto mismo se puede hacer con una selección de celdas. Respecto a las unidades veremos mas adelante un poco mas y respecto al alias es la misma propiedad que la ya vista con anterioridad.</p> <p><center></p> <p><img alt="Ajuste de propiedades de las celdas" src=../img/SS-DD/F5_5.gif><br> <em>Figura 5.5. Ajuste de propiedades de las celdas</em></p> <p></center></p> <h3 id=516-expresiones><font color=#AA0000>5.1.6. Expresiones</font><a class=headerlink href=#516-expresiones title="Permanent link">&para;</a></h3> <p>Técnicamente las expresiones deben comenzar con un signo igual '='. Sin embargo, la hoja de cálculo intenta ser inteligente; si se introduce lo que parece una expresión sin el '=' inicial, este se añadirá automáticamente.</p> <p>Las expresiones de celdas pueden contener números, funciones, referencias a otras celdas y referencias a propiedades del modelo. Las celdas se referencian por su columna (siempre en letra MAYÚSCULA) y su fila (número). Una celda también puede ser referenciada por su nombre o alias.</p> <p>El número de decimales mostrados puede diferir ya que depende de la configuración que establezcamos en preferencias.</p> <p>Es posible también introducir referencias a objetos del modelo 3D en las celdas para que los cambios que realizamos en el modelo 3D sea cambiado en la hoja de cálculo. En la animación de la Figura 5.6 vemos una aplicación simple del concepto para un cubo, un cilindro y una esfera.</p> <p><center></p> <p><img alt="Calculo de propiedades de objetos en celdas a partir del modelo 3D" src=../img/SS-DD/F5_6.gif><br> <em>Figura 5.6. Calculo de propiedades de objetos en celdas a partir del modelo 3D</em></p> <p></center></p> <p>El uso de los valores de las celdas de la hoja de cálculo para definir las propiedades del modelo 3D ya lo hemos visto anteriormente.</p> <p>En este punto hay que avisar que este banco de trabajo <strong>NO</strong> está totalmente desarrollado y por lo tanto habrá cosas que no funcionen como esperamos o simplemente lo hagan mal. Para más información sobre las expresiones y las funciones disponibles, véase la información en la wiki de FreeCAD sobre <a href=https://wiki.freecad.org/Expressions/es>Expresiones</a>.</p> <h3 id=517-recalculos-en-modelos-complejos><font color=#AA0000>5.1.7. Recálculos en modelos complejos</font><a class=headerlink href=#517-recalculos-en-modelos-complejos title="Permanent link">&para;</a></h3> <p>Cuando editamos el valor de una celda de una hoja de cálculo se activa un nuevo cálculo del modelo 3D, incluso si los cambios no afectan al modelo. Cuando tenemos un modelo complejo, un recálculo puede llevar bastante tiempo y, por supuesto, tener que esperar después de cada edición es bastante molesto. Tenemos tres posibles soluciones para esto:</p> <ul> <li><strong>Omitir temporalmente los recálculos</strong></li> </ul> <p>Para ello podemos hacer clic con el botón derecho sobre el nombre del archivo que contiene la hoja de cálculo y marcar la opción 'Saltar recalculado' del menú contextual. En la Figura 5.7 vemos la opción marcada.</p> <p><center></p> <p><img alt="Activar la opción 'Saltar recalculado'" src=../img/SS-DD/F5_7.png><br> <em>Figura 5.7. Activar la opción 'Saltar recalculado'</em></p> <p></center></p> <p>La desventaja de este método es que los nuevos valores no se mostrarán hasta que se vuelva a calcular el documento. En su lugar se muestra '#PENDING'. Podemos hacer el recálculo o bien lo hacemos de forma manual haciendo clic en el icono 'Actualizar pantalla' o 'Std Refresh' (animación de la Figura 5.8) o también podemos desmarcar la opción para que se vuelvan a realizar los cálculos.</p> <p><center></p> <p><img alt="Herramienta 'Actualizar pantalla'" src=../img/SS-DD/F5_8.gif><br> <em>Figura 5.8. Herramienta 'Actualizar pantalla'</em></p> <p></center></p> <ul> <li><strong>Usar una macro</strong></li> </ul> <p>Podemos descaargar y ejecutar la macro <a href="https://forum.freecadweb.org/viewtopic.php?f=8&t=48600#p419301">skipSheet.FCMacro</a>. Aunque ahorra algunos pasos respecto al paso anterior básicamente tiene el mismo inconveniente.</p> <ul> <li><strong>Colocar la hoja de cálculo en un archivo FreeCAD diferente</strong></li> </ul> <p>Consiste en hacer referencia a los datos de una hoja de cálculo externa desde un archivo .FCStd utilizando la siguiente sintaxis: "=NameOfFile#&lt;<myspreadsheet>&gt;.MyAlias". Esto nos ofrece la ventaja de que el recálculo se realiza en la propia hoja de cálculo sin afectar para nada al modelo 3D, pero la desventaja es que el modelo no se va a calcular automáticamente después de los cambios en la hoja de cálculo.</p> <p>En el escenario en el que primero abrimos el archivo de 'hoja de cálculo', cambiamos uno o más valores y luego abrimos el archivo del 'modelo', no habrá ninguna indicación de que el modelo deba volver a calcularse. Pero si ambos archivos están abiertos, el ícono 'Actualizar pantalla' se actualizará correctamente para el 'modelo' después de los cambios en el archivo 'hoja de cálculo'. Es decir, tampoco ofrece una gran ventaja respecto a los anteriores.</p> <h3 id=518-unidades><font color=#AA0000>5.1.8. Unidades</font><a class=headerlink href=#518-unidades title="Permanent link">&para;</a></h3> <p>La hoja de cálculo tiene una noción de dimensión (unidades) asociada con los valores de celda. Un número ingresado sin una unidad asociada no tiene dimensión. La unidad debe ingresarse inmediatamente después del valor del número, sin espacios intermedios. Si un número tiene una unidad asociada, esa unidad se utilizará en todos los cálculos. Por ejemplo, la multiplicación de dos longitudes en milímetros da un área en mm².</p> <p>Si una celda contiene un valor que representa una dimensión, debe ingresarse con su unidad asociada. Si bien en muchos casos simples se puede trabajar con un valor adimensional, no es nada recomendable el no introducir la unidad ya que hay algunas secuencias de operaciones que hacen que FreeCAD detecte unidades incompatibles en una expresión cuando a simple vista nos parece que la expresión debería ser válida.</p> <p>Un número adimensional no se puede cambiar a un número con una unidad mediante el cuadro de diálogo de propiedades de la celda. Uno puede poner una cadena de unidades, y esa cadena se mostrará; pero la celda aún contiene un número adimensional. Para cambiar un valor adimensional a un valor con una dimensión, el valor en sí debe volver a ingresarse con su unidad asociada.</p> <h3 id=519-enlaces-entre-celdas><font color=#AA0000>5.1.9. Enlaces entre celdas</font><a class=headerlink href=#519-enlaces-entre-celdas title="Permanent link">&para;</a></h3> <p>Es posible enlazar el contenido de unas celdas a otras celdas , con un mismo rango, en la hoja de cálculo. En la animación de la Figura 5.9 vemos como enlazamos el rango de celdas A7-C8 al rango de celdas A10-C11.</p> <p><center></p> <p><img alt="Enlace de celdas" src=../img/SS-DD/F5_9.gif><br> <em>Figura 5.9. Enlace de celdas</em></p> <p></center></p> <p>Las celdas enlazadas tienen un borde azul para resaltar que es un enlace. Si ahora cambiamos, por ejemplo el radio de la esfera, el cambio nos aparecerá inmediatamente en la celda C11, además de en la C8 que es donde se calcula el valor en función del que pongamos en el modelo 3D.</p> <p>Para eliminar un enlace de celdas basta con hacer clic con el botón derecho en una celda enlazada (no es necesario resaltar todo el rango enlazado) y seleccione 'Enlazar' en el menú contextual. En la ventana que se abre hacemos clic en el botón 'Desenlazar' y observamos que desaparece el recuadro azul. Los datos se quedan igual e incluso funcionan los cambios, pero la diferencia es que ahora podemos eliminar el contenido de esas celdas y cuando están enlazadas no podemos.</p> <p>La opción 'Ocultar dependencia del enlace' de la ventana 'Enlazar' se puede utilizar para evitar problemas con dependencias cíclicas entre hojas de cálculo. Por ejemplo, las celdas de la Hoja de cálculo A están vinculadas a la Hoja de cálculo B, y a su vez las celdas de la Hoja de cálculo B están vinculadas a otras celdas de la Hoja de cálculo A. Esta opción debe usarse con precaución porque las dependencias rotas pueden dañar nuestro archivo FreeCAD sin recibir ninguna advertencia al respecto.</p> <h2 id=52-banco-de-trabajo-dynamicdata><font color=#007575><strong>5.2. Banco de trabajo DynamicData</strong></font><a class=headerlink href=#52-banco-de-trabajo-dynamicdata title="Permanent link">&para;</a></h2> <p>Es un banco de trabajo externo que debemos instalar a través del 'Administrador de complementos' que tenemos en el menú Herramientas de FreeCAD. En la imagen 5.10 vemos este gestor de complemento con el banco ya instalado.</p> <p><center></p> <p><img alt="Banco de trabajo DynamicData instalado" src=../img/SS-DD/F5_10.png><br> <em>Figura 5.10. Banco de trabajo DynamicData instalado</em></p> <p></center></p> <p>Se trata de un banco de trabajo que es una alternativa al banco de trabajo Spreadsheet y que nos va a ser útil para personalizar propiedades de diseño. Debemos tener en cuenta que los archivos FCStd que contienen objetos DynamicData dd pueden ser compartidos con usuarios que no tengan el banco de trabajo DynamicData instalado, siendo completamente funcionales. Pero sin el banco de trabajo instalado, esos usuarios no podrán agregar/eliminar propiedades a menos que se haga mediante secuencias de comandos de Python.</p> <p>Antes de comenzar y con el 'Gestor de complementos' abierto hacemos clic sobre el banco de trabajo DynamicData y si en la ventana que se nos abre, en la esquina superior derecha, hay un botón 'Actualizar' lo pulsamos para obtener la última versión disponible de forma que debemos ver algo similar a la Figura 5.11.</p> <p><center></p> <p><img alt="Banco de trabajo DynamicData actualizado" src=../img/SS-DD/F5_11.png><br> <em>Figura 5.11. Banco de trabajo DynamicData actualizado</em></p> <p></center></p> <p>También podemos proceder como en la animación de la Figura 5.12 y comprobar todas las actualizaciones disponibles y aplicarlas a nuestra versión de FreeCAD.</p> <p><center></p> <p><img alt="Comprobar actualizaciones desde el Administrador de complementos" src=../img/SS-DD/F5_12.gif><br> <em>Figura 5.12. Comprobar actualizaciones desde el Administrador de complementos</em></p> <p></center></p> <p>Si nos cambiamos al banco de trabajo DynamicData veremos como aparece su barra de herramientas y una entrada en la barra de menús. En el menú veremos una opción de configuración del banco de trabajo que no nos aparece en la barra de herramientas.</p> <p>En la animación de la Figura 5.13 podemos observar como la barra de herramientas de DynamicData está presente (esto ocurre tras visitar una vez DynamicData) en otros bancos de trabajo para hacer accesibles sus herramientas.</p> <p><center></p> <p><img alt="Barra de herramientas DynamicData en otros bancos de trabajo" src=../img/SS-DD/F5_13.gif><br> <em>Figura 5.13. Barra de herramientas DynamicData en otros bancos de trabajo</em></p> <p></center></p> <h3 id=521-herramientas><font color=#AA0000>5.2.1. Herramientas</font><a class=headerlink href=#521-herramientas title="Permanent link">&para;</a></h3> <p>A continuación vamos a ver los iconos de las herramientas disponibles y una descripción breve de para que sirve cada una de ellas. Posteriormente veremos un ejemplo de aplicación donde serán utilizadas.</p> <p><center></p> <table> <thead> <tr> <th align=center>Icono</th> <th>Descripción</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Crear objeto" src=../img/SS-DD/iconos/DD/CreateObject.png></td> <td>Crea un nuevo objeto contenedor DynamicData</td> </tr> </tbody> </table> <p></center></p> <p><center></p> <table> <thead> <tr> <th align=center>Icono</th> <th>Descripción</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Agregar propiedad" src=../img/SS-DD/iconos/DD/AddProperty.png></td> <td>Agrega una nueva propiedad personalizada al objeto contenedor DynamicData seleccionado</td> </tr> </tbody> </table> <p></center></p> <p>Si existe mas de un objeto 'dd' y no se selecciona ninguno en la vista de árbol, este comando no estará activo.</p> <p>A partir de la versión 2.44, agregar una propiedad se realiza desde un solo cuadro de diálogo (Figura 5.14). Después de seleccionar el tipo de propiedad, el siguiente paso es darle un nombre ad y (opcionalmente) un nombre de grupo, información sobre herramientas y un valor inicial.</p> <p><center></p> <p><img alt="Ventana Agregar Propiedad dd" src=../img/SS-DD/F5_14.png><br> <em>Figura 5.14. Ventana Agregar Propiedad dd</em></p> <p></center></p> <p>Todos los nombres de propiedades se anteponen con "dd" automáticamente y la primera letra está en mayúscula. Si no nos gusta este sistema, podemos cambiar el nombre de la propiedad después de agregarla, pero se recomienda seguir la convención de nomenclatura dd o, de lo contrario, es posible que algunas funciones en el banco de trabajo no funcionen correctamente.</p> <p><center></p> <table> <thead> <tr> <th align=center>Icono</th> <th>Descripción</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Eliminar propiedad" src=../img/SS-DD/iconos/DD/RemoveProperty.png></td> <td>Herramienta para eliminar una propiedad agregada previamente con la herramienta Agregar propiedad</td> </tr> </tbody> </table> <p></center></p> <p>Se selecciona la propiedad que desea eliminar de la lista que se muestra. También se puede optar por eliminar todas las propiedades de una sola vez. <strong>Herramienta que debemos tener cuidado en su uso ya que la acción de eliminar propiedades no se puede deshacer</strong>.</p> <p><center></p> <table> <thead> <tr> <th align=center>Icono</th> <th>Descripción</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Importar alias" src=../img/SS-DD/iconos/DD/ImportAliases.png></td> <td>Herramienta para importar alias de hojas de cálculo seleccionadas como propiedades en el objeto dd seleccionado</td> </tr> </tbody> </table> <p></center></p> <p>Advertencia: las hojas de cálculo seleccionadas se modificarán. Las celdas que contienen los alias harán referencia a la propiedad del objeto dd.</p> <p><center></p> <table> <thead> <tr> <th align=center>Icono</th> <th>Descripción</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Importar restricciones con nombre" src=../img/SS-DD/iconos/DD/ImportNamedConstraints.png></td> <td>Herramienta para importar restricciones con nombre de bocetos seleccionados como propiedades en el objeto dd seleccionado</td> </tr> </tbody> </table> <p></center></p> <p>Advertencia: los bocetos seleccionados se modificarán. Todas las restricciones con nombre harán referencia a la propiedad del objeto dd.</p> <p><center></p> <table> <thead> <tr> <th align=center>Icono</th> <th>Descripción</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Copiar propiedad" src=../img/SS-DD/iconos/DD/CopyProperty.png></td> <td>Vincular paramétricamente una propiedad copiada o configurada</td> </tr> </tbody> </table> <p></center></p> <p><center></p> <table> <thead> <tr> <th align=center>Icono</th> <th>Descripción</th> </tr> </thead> <tbody> <tr> <td align=center><img alt=Ajustes src=../img/SS-DD/iconos/DD/Settings.png></td> <td>Herramienta para cambiar la configuración del banco de trabajo</td> </tr> </tbody> </table> <p></center></p> <p>Accesible solamente desde el menú DynamicData. En la Figura vemos las opciones de configuración del banco de trabajo DynamicData.</p> <p><center></p> <p><img alt="Setting de DynamicData" src=../img/SS-DD/F5_15.png><br> <em>Figura 5.15. Setting de DynamicData</em></p> <p></center></p> <h3 id=522-utilizacion-basica-de-dynamicdata><font color=#AA0000>5.2.2. Utilización básica de DynamicData</font><a class=headerlink href=#522-utilizacion-basica-de-dynamicdata title="Permanent link">&para;</a></h3> <p>Comenzamos por crear un nuevo archivo, nos situamos en el banco de trabajo dd y creamos un nuevo objeto que nos aparecerá en el árbol de objetos. Si hacemos clic sobre el mismo vemos que tiene dos propiedades o datos, un 'Label' o nombre que comienza con dd (como se aconseja) y un campo Dynamic Data que básicamente nos da información de la versión que tenemos instalada del banco de trabajo.</p> <p>Lo que si debemos tener siempre presente es que el objeto dd es un objeto contenedor para propiedades dinámicas po lo que, logicamente, podemos agregar propiedades desde aquí. Esto básicamente es lo mismo que crear un 'Alias' en una hoja de cálculo, disponiendo de tipos de propiedades entre los que podemos elegir. Una vez elegido el tipo de propiedad (acorde con el tipo que vamos a definir) y le damos un valor, que si no especificamos se tomará como cero por defecto. Podemos observar como el objeto dd pasa a tener un nuevo dato que podemos definir como hacemos habitualmente.</p> <p>En la animación de la Figura 5.16a vemos como hacer este proceso y como asociar la propiedad dd creada a un objeto 3D.</p> <p><center></p> <p><img alt="Creación de objeto, propiedad y uso de objeto DynamicData" src=../img/SS-DD/F5_16a.gif><br> <em>Figura 5.16a. Creación de objeto, propiedad y uso de objeto DynamicData</em></p> <p></center></p> <p>En la Figura 5.16b vemos el proceso de creación de un propiedad y el significado de cada uno de los campos que podemos cumplimentar.</p> <p><center></p> <p><img alt="Creación de propiedad DynamicData" src=../img/SS-DD/F5_16b.png><br> <em>Figura 5.16b. Creación de propiedad DynamicData</em></p> <p></center></p> <p>En la propiedad 'Tooltip' en realidad lo que ponemos es la pista rápida que nos dará si dejamos el cursor situado sobre la nueva propiedad al menos un segundo y una vez que esta ha sido aplicada.</p> <p>En la animación de la Figura 5.17 vemos una forma mas apropiada de crear propiedades, como usarlas y como interactuar con sus valores como datos dinámicos.</p> <p><center></p> <p><img alt="Mas propiedades y cambios de datos DynamicData" src=../img/SS-DD/F5_17.gif><br> <em>Figura 5.17. Mas propiedades y cambios de datos DynamicData</em></p> <p></center></p> <p>Esto lo podemos ver como que los contenedores dd sirven como una especie de almacén de todas nuestras variables y así en lugar de tener estos valores en un archivo de hoja de cálculo los tenemos en objetos DynamicData como datos dinámicos del objeto.</p> <p>Para ver otra forma de crear una propiedad o dato en el objeto dd primero vamos a eliminar una de las propiedades anteriores (la que tiene un nombre poco acorde) y así dejarla libre para la nueva tarea. En la animación de la Figura 5.18 vemos el proceso de eliminación. Una vez eliminada la propiedad nos dirigimos al cubo y eliminamos la ecuación de cálculo basada en la propiedad anterior.</p> <p><center></p> <p><img alt="Eliminar un propiedad en un objeto DynamicData" src=../img/SS-DD/F5_18.gif><br> <em>Figura 5.18. Eliminar un propiedad en un objeto DynamicData</em></p> <p></center></p> <p>Ahora vamos a ver el proceso para crear una propiedad (será la longitud del cubo) a partir de la herramienta de copia de propiedades. En primer lugar seleccionamos ambos objetos en la vista de árbol, hacemos clic en la herramienta de 'Copiar propiedad' y de las opciones disponibles escogemos según la animación de la Figura 5.19 ya que lo que pretendemos es copiar una propiedad del cubo a una nueva propiedad del objeto DynamicData existente.</p> <p><center></p> <p><img alt="Copia de una propiedad del cubo a una nueva propiedad del objeto DynamicData existente" src=../img/SS-DD/F5_19.gif><br> <em>Figura 5.19. Copia de una propiedad del cubo a una nueva propiedad del objeto DynamicData existente</em></p> <p></center></p> <p>Cuando finalicen los cambios ya podemos proceder a crear la formula a partir de la nueva propiedad y con los mismos efecto que hemos visto anteriormente.</p> <p>En la Figura 5.20 vemos el gráfico de dependencias (Herramientas -&gt; Gráfico de dependencias) y podemos observar como cada una de las propiedades del cubo están enlazadas a su correspondiente objeto DynamicData.</p> <p><center></p> <p><img alt="Gráfico de dependencias de 5-Pieza-1" src=../img/SS-DD/F5_20.png><br> <em>Figura 5.20. Gráfico de dependencias de 5-Pieza-1</em></p> <p></center></p> <p>Utilizando solamente un cubo parece de poca utilidad, pero imaginemos que tenemos muchos objetos 3D y sus propiedades las recopilamos en uno o varios objetos dd y ya le encontramos mas sentido al banco de trabajo. En la animación de la Figura 5.21 hemos creado un cilindro, le asociamos su propiedad radio al objeto dd y luego hacemos que la propiedad 'Altura' del cilindro sea la misma que la del cubo. Incluso vemos el funcionamiento después de realizar una operación booleana sobre los dos objetos.</p> <p><center></p> <p><img alt="Asociaciones de propiedades con dd" src=../img/SS-DD/F5_21.gif><br> <em>Figura 5.21. Asociaciones de propiedades con dd</em></p> <p></center></p> <p>El nuevo árbol de dependencias los vemos en la Figura 5.22, donde se observa claramente la mezcla de dependencias.</p> <p><center></p> <p><img alt="Gráfico de dependencias de 5-Pieza-1" src=../img/SS-DD/F5_22.png><br> <em>Figura 5.22. Gráfico de dependencias de 5-Pieza-1</em></p> <p></center></p> <p>Ya hemos visto como eliminar una propiedad dd y como eliminar el enlace en la propiedad del objeto pero también podemos romper el enlace existente sin necesidad de eliminar la propiedad, para ello tan solo debemos seleccionar el objeto 3D y haciendo clic en el icono de copiar propiedad, que ahora nos muestra esta posibilidad. En la animación de la Figura 5.23 tenemos el procedimiento para el ancho del cubo. La ventaja de romper el enlace radica en que la propiedad permanece intacta y en que la operación de eliminar la propiedad no se puede deshacer.</p> <p><center></p> <p><img alt="Rotura de un enlace en dd" src=../img/SS-DD/F5_23.gif><br> <em>Figura 5.23. Rotura de un enlace en dd</em></p> <p></center></p> <p>El mismo procedimiento se puede realizar haciendo clic sobre el objeto 'Fusion' y resultaría incluso mas apropiado hacerlo aquí, en el objeto 3D resultante, aunque en realidad se actúa sobre la propiedad del objeto fuente.</p> <p>Veamos ahora como al crear un enlace a la propiedad 'Placement' se crean varios vínculos en una sola acción, lo que evidentemente es mucho más rápido que crearlos uno por uno. También aprovechamos para ver que aunque hay una operación booleana por encima del objeto seguimos pudiendo realizar este tipo de operaciones. En la Figura 5.23 vemos el proceso completo.</p> <p><center></p> <p><img alt="Creación de enlaces multiples en propiedad Placement" src=../img/SS-DD/F5_24.gif><br> <em>Figura 5.24. Creación de enlaces multiples en propiedad Placement</em></p> <p></center></p> <p>Por comodidad de trabajo vamos a desplazar estos objetos hacia la derecha (50 mm es suficiente) para despejar la zona del origen de coordenadas. Para ello activamos la 'Cruz de ejes' desde el menú 'Ver'. Una realizado el desplazamiento ocultamos los objetos y la 'Cruz de ejes'.</p> <h3 id=523-importar-restricciones-de-un-boceto-a-dynamicdata><font color=#AA0000>5.2.3. Importar restricciones de un boceto a DynamicData</font><a class=headerlink href=#523-importar-restricciones-de-un-boceto-a-dynamicdata title="Permanent link">&para;</a></h3> <p>Veamos ahora el proceso para importar datos creados en un boceto a DynamicData. Vamos a utilizar la herramienta que vemos en la Figura 5.25, donde podemos apreciar su pista rápida, que traducida viene a indicar: <em>Importa restricción con nombre del boceto seleccionado al objeto dd</em>.</p> <p><center></p> <p><img alt="Pista rápida de la herramienta 'Importar restricción con nombre'" src=../img/SS-DD/F5_25.png><br> <em>Figura 5.25. Pista rápida de la herramienta 'Importar restricción con nombre'</em></p> <p></center></p> <p>Para comenzar vamos a crear un 'Body' y un boceto como el de la Figura 5.26. Las dimensiones se corresponden con las de un tubo rígido de cobre de una pulgada de diámetro nominal de tipo K.</p> <p><center></p> <p><img alt='Dimensiones del tubo rígido de cobre 1" tipo K' src=../img/SS-DD/F5_26.png><br> <em>Figura 5.26. Dimensiones del tubo rígido de cobre 1" tipo K</em></p> <p></center></p> <p>En la animación de la Figura 5.27 vemos como crear estas restricciones y como ponerles nombre.</p> <p><center></p> <p><img alt="Restricciones y nombre de las mismas" src=../img/SS-DD/F5_27.gif><br> <em>Figura 5.27. Restricciones y nombre de las mismas</em></p> <p></center></p> <p>En la Figura 5.28 observamos como aparece reflejado el trabajo anterior en los datos del boceto que hemos dibujado.</p> <p><center></p> <p><img alt="Las restricciones con sus nombres en los datos del boceto" src=../img/SS-DD/F5_28.png><br> <em>Figura 5.28. Las restricciones con sus nombres en los datos del boceto</em></p> <p></center></p> <p>A continuación vamos a seleccionar el objeto dd y manteniendo pulsada la tecla CTRL el boceto (podemos seleccionar en orden inverso) para observar que se activa la herramienta de importación (animación de la Figura 5.29) sobre la que hacemos clic.</p> <p><center></p> <p><img alt="Proceso inicial de importación" src=../img/SS-DD/F5_29.gif><br> <em>Figura 5.29. Proceso inicial de importación</em></p> <p></center></p> <p>Al final vemos que nos aparece una ventana que tiene como título 'Prueba de Sensatez o de juicio de DynamicData' que viene a realizarnos la advertencia que vemos en la ventana de la Figura 5.30 traducida.</p> <p><center></p> <p><img alt="Prueba de Sensatez o de juicio de DynamicData" src=../img/SS-DD/F5_30.png><br> <em>Figura 5.30. Prueba de Sensatez o de juicio de DynamicData</em></p> <p></center></p> <p>Como nos indica de forma clara, a partir de ahora los cambios en las dimensiones del boceto ya no los realizamos en este sino en el objeto dd. En la Figura 5.31 vemos esta propiedades en los datos de 'Vista combinada'.</p> <p><center></p> <p><img alt="Datos del boceto en el objeto dd de DynamicData" src=../img/SS-DD/F5_31.png><br> <em>Figura 5.31. Datos del boceto en el objeto dd de DynamicData</em></p> <p></center></p> <p>En la animación de la Figura 5.32 vemos que cuando entramos en la edición del boceto han cambiado a color naranja las restricciones lo que nos indica que es un valor vinculado a una fórmula. Si observamos las restricciones a la izquierda vemos justamente esto y si entramos en la expresión vemos como ahora esta restricción depende del valor de la variable en el objeto dd.</p> <p><center></p> <p><img alt="Cambios en el boceto debidos a la importación" src=../img/SS-DD/F5_32.gif><br> <em>Figura 5.32. Cambios en el boceto debidos a la importación</em></p> <p></center></p> <p>Al final de la animación vemos como realizar cambios en estas dimensiones y como sigue siendo posible asignar un expresión a esta propiedad del objeto dd a través de una fórmula, que por qué no, podría estar asociada a una hoja de cálculo.</p> <h3 id=524-importar-restricciones-de-una-hoja-de-calculo-a-un-objeto-dynamicdata><font color=#AA0000>5.2.4. Importar restricciones de una hoja de cálculo a un objeto DynamicData</font><a class=headerlink href=#524-importar-restricciones-de-una-hoja-de-calculo-a-un-objeto-dynamicdata title="Permanent link">&para;</a></h3> <p>Para ver el funcionamiento de esta herramienta vamos a necesitar crear una hoja de cálculo en nuestro proyecto, crear algún dato y ponerle su nombre o alias. En la animación de la Figura 5.33 partimos de las tareas anteriores ya realizadas y procedemos a usar la herramienta.</p> <p><center></p> <p><img alt="Importar datos de una hoja de cálculo a DynamicData" src=../img/SS-DD/F5_33.gif><br> <em>Figura 5.33. Importar datos de una hoja de cálculo a DynamicData</em></p> <p></center></p> <p>En la Figura 5.34 vemos la traducción del aviso que nos presenta esta importación. Es muy importante destacar aquí que las fórmulas no se importan, es mas se transforman en un simple dato numérico, por lo que si necesitamos realizar cálculos el proceso es convertirlos en datos dd y realizar los cálculos en las fórmulas que podemos crear en DynamicData. </p> <p><center></p> <p><img alt="Prueba de Sensatez o de juicio de DynamicData" src=../img/SS-DD/F5_34.png><br> <em>Figura 5.34. Prueba de Sensatez o de juicio de DynamicData</em></p> <p></center></p> <p>A estas altura quizá ya nos habrá ocurrido que alguna de estas operaciones no se realiza correctamente (no queda reflejada en el objeto dd) aunque hacemos correctamente el proceso. Una de las causas puede se, por ejemplo, usar caracteres no permitidos por DynamicData aunque si lo estén por FreeCAD, como puede ser el carácter "-" (guion normal) que no es un carácter válido para usar en nombres de objetos.</p> <p>Si ahora volvemos a la hoja de cálculo podemos observar como el alias de la celda permanece intacto, su valor también, pero si hacemos clic sobre ellas observamos como ese valor ya no es un número (Figura 5.35), sino un valor enlazado con un dato de DynamicData.</p> <p><center></p> <p><img alt="El valor de la celda con alias es un dato enlazado de DynamicData" src=../img/SS-DD/F5_35.png><br> <em>Figura 5.35. El valor de la celda con alias es un dato enlazado de DynamicData</em></p> <p></center></p> <p>Imaginemos que la situación es que la longitud de tubo establecida es la longitud mínima que se puede cortar y que los cortes comerciales tienen que ser múltiplos de ese valor. También podemos pensar en un futuro en cambiar esa longitud mínima. En la animación de la Figura 5.36 vemos como crear la fórmula de cálculo en el objeto dd partiendo de valores dd que han sido importados de la hoja de cálculo y como afectan los cambios a los valores tanto en el objeto dd como en la hoja de cálculo. Inicialmente observamos como todas las celdas con alias están enlazadas al objeto dd tras realizar la correspondiente importación.</p> <p><center></p> <p><img alt="Importar datos de una hoja de cálculo a DynamicData" src=../img/SS-DD/F5_36.gif><br> <em>Figura 5.36. Importar datos de una hoja de cálculo a DynamicData</em></p> <p></center></p> <p>Vamos a realizar un par de extrusiones con distintos valores (Figura 5.37) realizando las pertinentes copias del objeto.</p> <p><center></p> <p><img alt="Extruir a partir de datos en dd" src=../img/SS-DD/F5_37.gif><br> <em>Figura 5.37. Extruir a partir de datos en dd</em></p> <p></center></p> <p>En el enlace a <a href=../img/designs/5/5-Pieza-1.FCStd>5-Pieza-1.FCStd</a> tenemos disponible el archivo de diseño o fuente por si necesitamos consultar algún detalle.</p> <h3 id=525-copia-de-propiedades><font color=#AA0000>5.2.5. Copia de propiedades</font><a class=headerlink href=#525-copia-de-propiedades title="Permanent link">&para;</a></h3> <p>Vamos a partir de una situación similar a la de la Figura 5.38 en la que tengamos dos cuerpos con sus respectivos objetos. En mi caso he realizado una copia de "5-Pieza-1.FCStd" para trabajar a partir de los datos dd que ya teníamos.</p> <p><center></p> <p><img alt="Situación de partida para copia de propiedades" src=../img/SS-DD/F5_38.png><br> <em>Figura 5.38. Situación de partida para copia de propiedades</em></p> <p></center></p> <p>Antes de empezar con la herramienta en si vamos a ver como asignar a dd una propiedad con varios valores. Comenzamos por crear un objeto dd de tipo vector como vemos en la Figura 5.39.</p> <p><center></p> <p><img alt="Asignar propiedad tipo vector" src=../img/SS-DD/F5_39.gif><br> <em>Figura 5.39. Asignar propiedad tipo vector</em></p> <p></center></p> <p>Vamos a crear dos propiedades nuevas en dd referentes al color del objeto y al porcentaje de transparencia del mismo, tal y como vemos en la Figura 5.40. Estas propiedades no admiten la introducción de expresiones por lo que en 'Vista combinada -&gt; Propiedades -&gt; Vista' no podemos asignarle los nuevos valores dd creados.</p> <p><center></p> <p><img alt="Creamos propiedades que no admiten expresiones" src=../img/SS-DD/F5_40.png><br> <em>Figura 5.40. Creamos propiedades que no admiten expresiones</em></p> <p></center></p> <p>A través de la herramienta "Copia" de dd si vamos a poder relacionar estos valores, tal y como apreciamos en la Figura 5.41.</p> <p><center></p> <p><img alt="Copiar propiedad 'Color' de dd a objeto" src=../img/SS-DD/F5_41.gif><br> <em>Figura 5.41. Copiar propiedad 'Color' de dd a objeto</em></p> <p></center></p> <p>En la Figura 5.42 vemos el resultado de aplicar un proceso similar para la transparencia.</p> <p><center></p> <p><img alt="Copiar propiedad 'Transparencia' de dd a objeto" src=../img/SS-DD/F5_42.png><br> <em>Figura 5.42. Copiar propiedad 'Transparencia' de dd a objeto</em></p> <p></center></p> <p>Vamos ahora a copiar la posición que establecimos para el paralelepípedo a partir de los datos de dd en el contenedor dd de forma paramétrica. Para ello seleccionamos de la forma que vemos en la Figura 5.43 y le damos un nombre apropiado a la nueva propiedad de DynamicData.</p> <p><center></p> <p><img alt="Copiar propiedad de cuerpo u objeto para crear una propiedad dd" src=../img/SS-DD/F5_43.gif><br> <em>Figura 5.43. Copiar propiedad de cuerpo u objeto para crear una propiedad dd</em></p> <p></center></p> <p>En la Figura 5.44 vemos como afecta cambiar los datos en dd al objeto 3D omo consecuencia de la copia paramétrica de estos desde el body del paralelepipedo a una propiedad dd que en realidad tiene varias opciones.</p> <p><center></p> <p><img alt="Efecto de cambiar datos en dd de una propiedad que es copia de una de un cuerpo" src=../img/SS-DD/F5_44.gif><br> <em>Figura 5.44. Efecto de cambiar datos en dd de una propiedad que es copia de una de un cuerpo</em></p> <p></center></p> <p>La copia sin enlazar los valores simplemente copia esos valores pero futuros cambios no harán que se reflejen en la copia pues no están enlazados.</p> <p>En el enlace a <a href=../img/designs/5/5-Pieza-2.FCStd>5-Pieza-2.FCStd</a> tenemos disponible el archivo de diseño o fuente por si necesitamos consultar algún detalle.</p> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Pie> <a href=../4-parametros/ class="md-footer__link md-footer__link--prev" aria-label="Anterior: 4. Diseño paramétrico en FreeCAD. Otros enfoques" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Anterior </span> 4. Diseño paramétrico en FreeCAD. Otros enfoques </div> </div> </a> <a href=../6-TD/ class="md-footer__link md-footer__link--next" aria-label="Siguiente: 6. Dibujo técnico" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Siguiente </span> 6. Dibujo técnico </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2022 - 2035 Federico Coca </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}}</script> <script src=../assets/javascripts/bundle.9c69f0bc.min.js></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>